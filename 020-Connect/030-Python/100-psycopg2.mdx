---
title: Connect to Postgres with psycopg2
navTitle: psycopg2
keywords: ['python', 'postgres', 'psycopg2']
description: Connect to Postgres with psycopg2
slug: /python/connect/psycopg2
published: true
---

## psycopg2

https://www.psycopg.org/docs/module.html

TESTED

### Connect via DSN

See psql for DSN and how itâ€™s constructed

```python
import psycopg2

dsn = "postgresql://<WORKSPACE_ID>:<API_KEY>@<REGION>.sql.xata.sh:5432/<DATABASE_NAME>:<BRANCH_NAME>"

cnn = psycopg2.connect(dsn)
cur = cnn.cursor()
r = cur.execute("SELECT 1")
print(r)
cnn.close()
```

### Connect via params

```python
import psycopg2

cnn = psycopg2.connect(
  dbname="<DATABASE_NAME>:<BRANCH>",
  user="<WORKSPACE_ID>",
  password="<API_KEY>",
  host="<REGION>.sql.xata.sh",
  port=5432,
)
cur = cnn.cursor()
r = cur.execute("SELECT 1")
print(r)
cnn.close()
```

## asyncpg

TESTED

```python
import asyncpg
import asyncio

async def get_server_version():
  connection = await asyncpg.connect(
    database="<DATABASE_NAME>:<BRANCH>",
    user="<WORKSPACE_ID>",
    password="<API_KEY>",
    host="<REGION>.sql.xata.sh",
    port=5432,
  )
  version = connection.get_server_version()
  print(version)
  await connection.close()

asyncio.run(get_server_version())

# Print: Postgres version is ServerVersion(major=15, minor=0, micro=1, releaselevel='final', serial=0)
```

## pg8000.native

```python
import pg8000.native

con = pg8000.native.Connection(
  database="<DATABASE_NAME>:<BRANCH>",
  user="<WORKSPACE_ID>",
  password="<API_KEY>",
  host="<REGION>.sql.xata.sh",
  port=5432,
)
res = con.run("SELECT 1")
print(res)
con.close()
```

pg8000.dbapi

TESTED

```python
import pg8000.dbapi

con = pg8000.dbapi.Connection(
  database="<DATABASE_NAME>:<BRANCH>",
  user="<WORKSPACE_ID>",
  password="<API_KEY>",
  host="<REGION>.sql.xata.sh",
  port=5432,
)
cursor = con.cursor()
cursor.execute("SELECT 1")
print(cursor.fetchone())
con.close()
```

## Django

TESTED

https://docs.djangoproject.com/en/5.0/ref/databases/#postgresql-notes

settings.py

```python
DATABASES = {
  'default': {
    'ENGINE': 'django.db.backends.postgresql_psycopg2',
    'NAME': '<DATABASE_NAME>:<BRANCH>',
    'USER': '<WORKSPACE_ID>',
    'PASSWORD': '<API_KEY>',
    'HOST': '<REGION>.sql.xata.sh',
    'PORT': '5432',
  }
}
```

https://stackpython.medium.com/how-to-start-django-project-with-a-database-postgresql-aaa1d74659d8

Django migrations are not fully supported on shared clusters, as the create type statement is not allowed. For full support, you must use a dedicated cluster, see limitations for more information on supported statements.
